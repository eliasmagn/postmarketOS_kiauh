# Checklist

- [x] Detect and support both `apt` and `apk` package managers inside the helper utilities.
- [x] Guard package-manager detection with `/etc/os-release` so apk-capable systems ignore stray `apt-get` compatibility shims.
- [x] Translate Debian-specific dependency names to their Alpine/postmarketOS equivalents during installation.
- [x] Align cross-compilation toolchain translations so `apk` pulls `binutils-arm-none-eabi`, `gcc-arm-none-eabi`, `binutils-avr`, and `gcc-avr` without errors.
- [x] Refresh documentation to describe the new package manager support.
- [x] Ship an apk-aware KlipperScreen installer shim so X11 remains installable on postmarketOS alongside the updated Wayland guidance.
- [x] Inventory component installer dependencies and document the Debian ➜ Alpine package mapping, including missing ports.
- [x] Capture kernel configuration guidance for Klipper, Moonraker, KlipperScreen, and crowsnest to support custom postmarketOS builds.
- [x] Introduce init-system detection and mirror service management for systemd and OpenRC, updating every component to use the shared abstraction.
- [x] Add Phosh/Plasma Wayland presets to the KlipperScreen installer and generate launchers during installation.
- [x] Extend the Wayland preset helper with an Sxmo wlroots profile so msm8953 reference images launch KlipperScreen reliably.
- [x] Auto-detect built-in displays and pre-seed `KlipperScreen.conf` with size/orientation hints on first install.
- [x] Add a panorama-mode prompt that rewrites KlipperScreen display defaults and seeds an X11 rotation helper during install.
- [x] Ensure KlipperScreen panorama/default resolution updates stay within the `[main]` section so custom printer blocks don't swallow the overrides.
- [x] Generate a postmarketOS-style auto-rotation helper that listens to `monitor-sensor` and rotates KlipperScreen outputs through `wlr-randr`/`xrandr`.
- [x] Teach the auto-rotation helper to respect backend hints and wait for X11/Wayland availability so console-first installs keep working.
- [x] Autostart KlipperScreen automatically on Phosh/Plasma desktops and OpenRC consoles without relying on systemd units.
- [x] Enable generated Wayland services automatically by running `systemctl --user enable --now …` when available and wiring OpenRC runlevel symlinks, falling back to manual guidance on failure.
- [x] Install and register a native OpenRC KlipperScreen service so standalone console installs boot directly into the UI.
- [x] Ensure apk-based KlipperScreen X11 installs write Xwrapper permissions so OpenRC services can spawn Xorg without logind.
- [x] Ensure the self-update routine repoints the KIAUH `origin` remote to the postmarketOS community fork by default while allowing `KIAUH_REPO_URL` overrides for personal forks.
- [x] Patch `KlipperScreen-start.sh` with a default `KS_XCLIENT` fallback so manual launches still reach the UI when services omit the variable.
- [x] Gate Moonraker update-manager's `managed_services` stanza behind the selected KlipperScreen autostart backend.
- [x] Teach the Moonraker dependency parser to reuse the Debian list when apk-based systems lack a dedicated entry and translate it on the fly.
- [x] Document postmarketOS-specific prerequisites for the init-service abstraction and Wayland presets in the README.
- [x] Defer the Wayland preset prompt until after the backend choice so X11 installs no longer see the question prematurely.
- [x] Default the KlipperScreen installer to the minimal dependency set and gate optional extras behind an explicit opt-in.
- [x] Replace KlipperScreen's NetworkManager install reboot with a manual reminder so unattended runs exit cleanly.
- [x] Detect NGINX configuration directory variants so web UIs install cleanly on Alpine/postmarketOS hosts.
- [x] Inspect `/etc/nginx/nginx.conf` to respect whichever include directory nginx currently loads when both `conf.d` and `http.d` exist so generated drop-ins stay active.
- [x] Ensure freshly generated `printer.cfg` examples include the installed Mainsail/Fluidd configs by correctly detecting existing web UI directories.
- [x] Detect missing `grep -P` support on BusyBox-based systems, install GNU `grep`, and retry the Moonraker policykit helper automatically.
- [x] Retry Moonraker's policykit helper after authentication failures so doas-backed sudo shims can prompt again instead of misdiagnosing the error as a missing GNU `grep`.
- [x] Provide an apt-compatible Moonraker Update Manager drop-in for apk hosts so system updates keep working without PackageKit warnings.
- [x] Detect nftables firewalls and offer guided allow-rule creation for Moonraker and web UI ports with selectable network scopes.
- [x] Add fallback messaging when the default nftables input chain is missing, linking to the postmarketOS firewall guide for manual configuration steps.
- [x] Ship an apk/OpenRC-aware crowsnest installer so Fluidd and Mainsail webcam panels work without manual service tweaks.
- [x] Gracefully handle missing NGINX site definitions by falling back to stored listen ports during menu rendering instead of aborting.
- [x] Pause menu spinners around privileged commands so sudo password prompts stay visible during update checks.
- [x] Guard menu spinner teardown so stopping a non-existent animation no longer raises exceptions during loading flows.
- [x] Accept case-insensitive yes/no responses (including `1`/`0` and `on`/`off`) so prompt validation works regardless of the
      input casing users prefer.
- [x] Offer optional sudo credential caching that only prompts when the first privileged action runs so subsequent steps reuse the timestamp cache and drop it when exiting.
- [x] Detect limited sudo shims (e.g., doas-sudo-shim) and gracefully skip caching when timestamp flags are unsupported so menus avoid repeated option errors.
- [x] Stream NGINX site templates with `sudo tee` so doas-backed systems can't drop the config between generation and placement.
- [x] Provision `/etc/nginx/sites-available` and `/etc/nginx/sites-enabled` on Alpine-style hosts and add an include so multiple dashboards remain loadable without rewriting `nginx.conf`.
- [x] Ensure the sites include helper seeds the resolved NGINX include directory before streaming `kiauh-sites.conf` so default configurations load the generated sites.
- [x] Create the resolved NGINX `conf.d` directory before copying shared configs so Fluidd installs succeed on minimal images.
- [x] Route warning messages through the shared `Logger.print_warn` helper to keep prompts consistent across installers and extensions.
- [ ] Capture feedback from postmarketOS test runs and extend the compatibility matrix as needed.
- [ ] Automate KlipperScreen smoke tests on postmarketOS handsets/tablets to validate display presets after updates.
- [ ] Upstream missing Alpine packaging workarounds (e.g., `packagekit`, `libcamera-apps-lite`) to reduce custom steps.
- [ ] Coordinate with KlipperScreen maintainers on integrating the Wayland wrapper defaults upstream.
- [x] Offer optional WireGuard provisioning so remote access can be secured without manual VPN setup.
